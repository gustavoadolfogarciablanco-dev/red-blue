# Implementation Plan: Multi-Language Support (ES / EN)

**Branch**: `001-i18n-lang-switch` | **Date**: 2026-02-24 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `specs/001-i18n-lang-switch/spec.md`

---

## Summary

Add client-side multi-language support (Spanish / English) to the Red and Blue landing page. A dedicated `js/i18n.js` module manages translation dictionaries, language detection (browser → localStorage fallback to `es`), and dynamic DOM updates via `data-i18n` attributes. A visible language toggle is added to the navigation. All translatable strings across Hero, Services, Technologies, Contact, and Footer are replaced with `data-i18n`-bound elements. Page `<title>`, meta description, and `<html lang>` update on switch. Language preference persists in `localStorage` across visits. The page URL never changes.

---

## Technical Context

**Language/Version**: HTML5, CSS3, JavaScript ES6+ (vanilla, no framework, ES modules)
**Primary Dependencies**: None new — GSAP + ScrollTrigger (CDN) already in place; Google Fonts Syne + DM Sans already loaded
**Storage**: `localStorage` (browser, key: `'lang'`, values: `'es'` | `'en'`)
**Testing**: Manual browser testing (DevTools, language switching, localStorage inspection)
**Target Platform**: Modern browsers (Chrome, Firefox, Safari, Edge); deployed as static site on Vercel
**Project Type**: Static single-page web application (landing page)
**Performance Goals**: Language switch completes in <300ms (SC-002); Lighthouse score ≥90 maintained (SC-007)
**Constraints**: Single URL — no `/en/`, `/es/` routing; no server-side rendering; no external i18n library
**Scale/Scope**: 1 HTML file, 1 new JS module (~150 lines), ~55 translatable strings, 2 languages

---

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle                                      | Status | Notes                                                                  |
|------------------------------------------------|--------|------------------------------------------------------------------------|
| Performance: Lighthouse ≥90                    | ✅ PASS | Pure JS dictionary, zero new network requests, synchronous DOM updates |
| No unnecessary libraries                       | ✅ PASS | No external i18n lib; vanilla JS module only                           |
| Code modular, documented, maintainable         | ✅ PASS | Isolated `js/i18n.js` module with clear public API                     |
| Accessibility WCAG AA                          | ✅ PASS | Selector keyboard-operable; `<html lang>` updated on switch            |
| UX: intuitive and consistent                   | ✅ PASS | Selector in nav, persistent choice, no layout shift on switch           |
| Internacionalización habilitada (constitution) | ✅ PASS | This feature directly implements this principle                         |

**Post-design re-check**: ✅ All gates pass. No complexity violations.

---

## Project Structure

### Documentation (this feature)

```text
specs/001-i18n-lang-switch/
├── plan.md              # This file
├── research.md          # Phase 0: strategy decisions
├── data-model.md        # Phase 1: translation key inventory, data entities
├── quickstart.md        # Phase 1: how to add/modify translations
├── contracts/
│   └── i18n-module.md   # Phase 1: public API contract for js/i18n.js
└── tasks.md             # Phase 2: generated by /speckit.tasks
```

### Source Code Changes

```text
js/
├── i18n.js              ← NEW: translation dictionaries + initI18n, applyLanguage, t()
└── main.js              ← MODIFIED: import initI18n, move form messages to i18n keys

index.html               ← MODIFIED: data-i18n-* attributes on all translatable elements,
                                      lang selector button added to .nav__right,
                                      <html lang> managed by JS (initial value 'es')
```

**Structure Decision**: Single static web project. All source files at repository root. No build step required — vanilla ES modules loaded directly by the browser.

---

## Phase 0: Research Summary

All technical decisions resolved. See `research.md` for full rationale.

| Decision                    | Choice                                                       |
|-----------------------------|--------------------------------------------------------------|
| i18n strategy               | Client-side JS dictionary objects in `js/i18n.js`            |
| DOM binding                 | `data-i18n` / `data-i18n-placeholder` / `data-i18n-aria` attributes |
| Language persistence        | `localStorage` key `'lang'`                                  |
| Detection priority          | localStorage → navigator.language → default `'es'`           |
| Language selector           | Toggle button in `.nav__right`, shows OTHER language code    |
| SEO update                  | `document.title`, `meta[name="description"]`, `<html lang>` |

---

## Phase 1: Design Summary

### Data Model

- ~55 translatable strings organized in 7 groups (SEO, nav, hero, services, technologies, contact, footer)
- Full key inventory documented in `data-model.md`
- DOM binding contract: `data-i18n`, `data-i18n-placeholder`, `data-i18n-aria`, `data-i18n-html`

### Module Contract

- Public API documented in `contracts/i18n-module.md`
- Exports: `initI18n()`, `applyLanguage(code)`, `t(key)`, `getCurrentLang()`
- Zero side effects until `initI18n()` is called

### Quickstart

- Step-by-step guide for adding new strings in `quickstart.md`
- Validation checklist for contributors

---

## Implementation Sequence (for /speckit.tasks)

### Phase 1 – Setup: New i18n Module

1. Create `js/i18n.js` with full ES/EN translation dictionaries
2. Implement `t(key)`, `getCurrentLang()`, `detectLanguage()`, `applyLanguage()`, `initI18n()`

### Phase 2 – HTML: Add `data-i18n` Attributes

3. Add `data-i18n` to all translatable text nodes in `index.html`
4. Add `data-i18n-placeholder` to form inputs/textarea
5. Add `data-i18n-aria` to elements with `aria-label`
6. Add language selector button to `.nav__right` in `index.html`

### Phase 3 – JS Integration

7. Import `initI18n` in `js/main.js` and call it before GSAP init
8. Move hardcoded Spanish form validation/success messages to i18n keys

### Phase 4 – Validation

9. Manual test: browser set to EN → verify all sections in English
10. Manual test: browser set to ES (or unsupported lang) → verify Spanish
11. Manual test: localStorage persistence across page reloads
12. Manual test: Lighthouse score ≥90
13. Verify `<html lang>`, `document.title`, meta description update on switch
